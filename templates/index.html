<!DOCTYPE html >
<html>
	<head>
		<meta charset="UTF-8">
		<!-- <link href='https://fonts.googleapis.com/css?family=Raleway' rel='stylesheet'> -->
		<style type="text/css">

			html, body {
				background-image: linear-gradient(to bottom, rgba(105,0,173,1), rgba(71,34,195,1));
				background-repeat: no-repeat;
			    background-attachment: fixed;
				/* height: 100%; */
			    /* margin: 0; */
				font-family: Roboto;
				/* font-family: 'Andale Mono, monospace'; */
			}

			/* #background { */
				/* position:absolute; z-index:0; width:100%; height:100%; */
			/* } */

			#start {
				background-color: whitesmoke;
				box-shadow: 5px 5px 5px #200347;
				border-radius: 10px;
				height: 10%;
				width: 15%;

				position: absolute;
				margin-top: 15%;
				margin-left: auto;
				margin-right: auto;
				left: 0;
				right: 0;

				overflow-x:hidden;
				font-size: calc(1em + 1vw);
			}

			#main {
				margin-left: auto;
				margin-right: auto;
				left: 0;
				right: 0;
				color: whitesmoke;
				/* font-size: calc(2em + 2vw); */
			}

			#menu {
				color: white;
				width: 2%;
				height: 2%;
			}

			#time {
				margin-top: 5%;
				text-align: center;
				/* margin-left: auto;
				margin-right: auto;
				left: 0;
				right: 0; */
				font-size: calc(8em + 8vw);
			}

			#date {
				color: rgb(185, 185, 185);
				margin-top: -15%;
				text-align: center;
				font-size: calc(0.5em + 0.5vw);
			}

			#weather {
				text-align: center;
				/* margin-top: -15%; */
				font-size: calc(1em + 1vw);
			}

			#city {
				color: rgb(185, 185, 185);
				font-size: calc(0.5em + 0.5vw);
				margin-top: 12%;
				text-align: center;
			}
			
			#error {
				margin-top: 15%;
				font-size: calc(3em + 3vw);
				text-align: center;
				color: white;
			}
</style>
</head>
<body>
	<!-- <div id="main">
		<img src="menu.svg" id="menu">
		<p id="time">11 31 12</p>
		<p id="date">Cуббота, 15 апреля</p>
		<p id="weather">+15 пасмурно</p>
		<p id="city">Москва</p>
	</div> -->
	<!-- <p id="error">Такой город не найден :(</p> -->
	<button id="start" onclick="GetCityValue()">Узнать погоду</button>
</body>
<!-- <script src="main.js"></script> -->
<script>
	function GetDate(time) {
	var date = new Date(time * 1000);
	var hours = date.getHours();
	var minutes = "0" + date.getMinutes();
	var seconds = "0" + date.getSeconds();

	var formattedTime = hours + ':' + minutes.substr(-2) + ':' + seconds.substr(-2);

	console.log(formattedTime);
		var d = new Date();
		var days = ["Воскресенье","Понедельник","Вторник","Среда","Четверг","Пятница","Суббота"];
		console.log("Сейчас " + days[d.getUTCDay()] + ", " + d.getUTCHours() + ":" + d.getUTCMinutes()); //time doesnt work correctlly
	}
	
	function CreateRequest(city) {
		if (city == "") {
			return ;
		}

		var requestURL = 'http://api.openweathermap.org/data/2.5/weather?q='
			+ city + '&appid=86c0cb2383f69fc2f22f63961ba83dc8&units=metric&lang=ru';
		var request = new XMLHttpRequest();
		request.open('GET', requestURL);
		request.responseType = 'json';
		request.send();
	
		request.onload = function() {
			var json = request.response;
			console.log(json);
			
			if (json.cod == 404) {
				CreateErrorTag();
				return ;
			}
			CreateMainDiv(json);			
		}
	}

	function GetCityValue() {
		var city = prompt('В каком городе вы живете?', 'Москва');
		CreateRequest(city);
		RemoveStartButton();
	}

	function RemoveStartButton() {
		var button = document.getElementById("start");
		if (button != null) {
			button.remove();
		}
	}

	function CreateStartButton() {
		var button = document.createElement("button");
		button.id = "start";
		button.innerText = "Узнать погоду";
		document.body.append(button);
		button.onclick(GetCityValue());
	}

	function ParseDescription(description) {
		if (description.search('пасмурно') != -1) {
			;
		} else if (description.search('ясно') != -1) {
			;
		} else if (description.search('снег') != -1) {
			;
		} else if (description.search('дождь') != -1) {
			
		} else if (description.search('обл') != -1
			|| description.search('пасмурно')) {
		}
	}
	
	function CreateErrorTag() {
		var img = CreateMenuImg();
		document.body.append(img);

		var p = document.createElement("p");
		p.id = "error";
		p.innerText = 'Такой город не найден :(';
		document.body.append(p);
	}
	
	function CreateMenuImg() {
		var img = document.createElement("img");
		img.src = "menu.svg";
		img.id = "menu";
		return img;
	}

	function CreateMainDiv(json) {
		var div = document.createElement("div");
		div.id = "main";

		var img = CreateMenuImg();

		var p1 = document.createElement("p");
		p1.id = "time";
		p1.innerText = '11 31 12';

		var p2 = document.createElement("p");
		p2.id = "date";
		p2.innerText = 'Суббота, 1 апреля';

		var p3 = document.createElement("p");
		var temp = parseInt(json['main']['temp']) > 0
				? '+' + json['main']['temp']
				: json['main']['temp']; 
		p3.id = "weather";
		
		p3.innerText = temp + ' ' + json['weather']['0']['description'];

		var p4 = document.createElement("p");
		p4.id = "city";
		p4.innerText = json['name'];

		document.body.append(div);
		document.getElementById('main').appendChild(img); 
		document.getElementById('main').appendChild(p1); 
		document.getElementById('main').appendChild(p2); 
		document.getElementById('main').appendChild(p3); 
		document.getElementById('main').appendChild(p4); 
	}
</script>
</html>